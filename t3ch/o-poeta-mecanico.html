<!DOCTYPE html>
<html>
<style>

		@font-face { font-family: "gohu"; src: url("/gohu.woff") format('woff'); }
		body {
			font-family: 'gohu', monospace;
			max-width: 50em;
			margin: 0 auto;
			color: white;
			background: black;
			line-height: calc(1ex / 0.32);
			margin-top: 3em;
		}
		pre {
			font-family: 'gohu', monospace;
			white-space: pre-wrap;
			line-height: 125%;
      background-color: #111;
      padding: 1em;
		}
		@media only screen and (max-width:768px) {
			body {
				max-width:100%;
			}
		}
		a:link {
			color: #0a0 ;
		}
		a:visited {
			color: #004100 ;
		}
		td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
		span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
		td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
		span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
		.codehilite .hll { background-color: #0000ff }
		.codehilite { background: #000000; }
		.codehilite .c { color: #00ff00 } /* Comment */
		.codehilite .k { color: #ff0000 } /* Keyword */
		.codehilite .ch { color: #00ff00 } /* Comment.Hashbang */
		.codehilite .cm { color: #00ff00 } /* Comment.Multiline */
		.codehilite .cp { color: #e5e5e5 } /* Comment.Preproc */
		.codehilite .cpf { color: #00ff00 } /* Comment.PreprocFile */
		.codehilite .c1 { color: #00ff00 } /* Comment.Single */
		.codehilite .cs { color: #00ff00 } /* Comment.Special */
		.codehilite .kc { color: #ff0000 } /* Keyword.Constant */
		.codehilite .kd { color: #ff0000 } /* Keyword.Declaration */
		.codehilite .kn { color: #ff0000 } /* Keyword.Namespace */
		.codehilite .kp { color: #ff0000 } /* Keyword.Pseudo */
		.codehilite .kr { color: #ff0000 } /* Keyword.Reserved */
		.codehilite .kt { color: #ee82ee } /* Keyword.Type */
		.codehilite .s { color: #87ceeb } /* Literal.String */
		.codehilite .no { color: #7fffd4 } /* Name.Constant */
		.codehilite .nf { color: #ffff00 } /* Name.Function */
		.codehilite .nv { color: #eedd82 } /* Name.Variable */
		.codehilite .sa { color: #87ceeb } /* Literal.String.Affix */
		.codehilite .sb { color: #87ceeb } /* Literal.String.Backtick */
		.codehilite .sc { color: #87ceeb } /* Literal.String.Char */
		.codehilite .dl { color: #87ceeb } /* Literal.String.Delimiter */
		.codehilite .sd { color: #87ceeb } /* Literal.String.Doc */
		.codehilite .s2 { color: #87ceeb } /* Literal.String.Double */
		.codehilite .se { color: #87ceeb } /* Literal.String.Escape */
		.codehilite .sh { color: #87ceeb } /* Literal.String.Heredoc */
		.codehilite .si { color: #87ceeb } /* Literal.String.Interpol */
		.codehilite .sx { color: #87ceeb } /* Literal.String.Other */
		.codehilite .sr { color: #87ceeb } /* Literal.String.Regex */
		.codehilite .s1 { color: #87ceeb } /* Literal.String.Single */
		.codehilite .ss { color: #87ceeb } /* Literal.String.Symbol */
		.codehilite .fm { color: #ffff00 } /* Name.Function.Magic */
		.codehilite .vc { color: #eedd82 } /* Name.Variable.Class */
		.codehilite .vg { color: #eedd82 } /* Name.Variable.Global */
		.codehilite .vi { color: #eedd82 } /* Name.Variable.Instance */
		.codehilite .vm { color: #eedd82 } /* Name.Variable.Magic */
	
</style>
<head>
  <meta charset="UTF-8">
</head>

<body><h1>o poeta mecanico</h1>
<p>Poemas sao expressoes textuais. As vezes felizes, as vezes tristes; As vezes dificeis de compreender, as vezes tao simples quanto a mais simples das somas matematicas. Poemas sao, em geral, expressoes sentimentais de alguem que prefere escrever Ã  aderir qualquer outro meio de expressao artistica.<br />
O mundo esta repleto de poemas, e poemas estao repletos de um unico fator comum:  <strong>Vida</strong>. Por algum motivo, alguma mente humana os deu um inicio e um fim, com alguma finalidade, para que o possamos ler.  </p>
<blockquote>
<p>â€œA vida e a respiracao hipocondriaca do mundo no coracao. Ela me apaga, nunca e so. Entao o mundoâ€¦ as estrelasâ€¦ que tanto tem ruido Ã s carnificinas que que julgamos tao pequenas: Linhas que nos levam Ã  um caminho. tinha uma pedra no meio do caminho tinha uma pedra no meio do ser.â€  </p>
</blockquote>
<p><strong>Ao ler esta poesia, qual sentimento te abraca?</strong>  </p>
<hr />
<p>Caso tenha reparado tracos de algum(a) escritor nacional na poesia acima, voce possui uma razao parcial: O texto foi escrito por uma Rede Neural(Manualmente Adaptada e corrigida gramaticalmente) criada em  <strong>modelo sequencial</strong>, utilizando  <strong>entropia cruzada</strong>  e  <strong>memoria de longo prazo</strong>, tomando base em textos de escritores Brasileiros popularmente conhecidos.<br />
â€œ_Teria um poema gerado por um computador algum proposito? Um proposito alem de o de ser gerado por um computador? Seriam as emocoes transmitidas por ele reais? A randomicidade inerente Ã  maquina tornaria a arte gerada por ela, a arte generativa, inferior ou menos sagrada_?â€  </p>
<h1><strong>Rede Neural Artificial? O que e isso?</strong></h1>
<p>Redes neurais artificiais(<strong>RNA</strong>) sao um conjunto de  <strong>algoritmos matematicos</strong>, modelados vagamente por um  <strong>cerebro humano</strong>, projetados para  <strong>identificar padroes</strong>. Elas  <strong>interpretam</strong>  os dados sensoriais atraves de um tipo de  <strong>percepcao da maquina</strong>, rotulando ou agrupando dados brutos. Os padroes que eles reconhecem sao  <strong>numericos</strong>, e podem ser perceptiveis Ã  qualquer dado do mundo real, sejam imagens, sons ou textos. Redes neurais Artificiais sao uma abstracao da rede neural biologica. Seu objetivo nao e replicar, mas sim servir de modelo para o aprendizado e resolucoes de problemas complexos.  </p>
<p><img alt="" src="https://miro.medium.com/max/393/1*K3kwICoLdrxczie-tYz7jQ.jpeg" />  </p>
<p>RNA model with math format  </p>
<h1>Neuronios Artificiais? O que e isso?</h1>
<p>Assim como no cerebro humano, os neuronios artificiais possuem a missao de transmitir informacoes.  </p>
<p><img alt="" src="https://miro.medium.com/max/828/1*lh5hiL8XKjMaWuWzauhnrQ.png" />  </p>
<p><strong>Imaginemos a seguinte situacao</strong>: Queremos realizar uma previsao de preco de uma casa que esta sendo construida em uma regiao  <strong>R</strong>  e que temos intencao de comprar. Para isso, recolhemos dados de diversas casas que ja existem na regiao, e estes dados sao â€” Para fins de agilidade â€”  <strong>Tamanho</strong>  e  <strong>preco</strong>.<br />
Portanto,  <strong>y = f(x)</strong>, o que significa que o preco da casa <strong>(y)</strong>  e a funcao do tamanho da casa  <strong>(x).</strong>  Vejamos em um grafico:  </p>
<p><img alt="" src="https://miro.medium.com/max/1120/1*EpawrKOBRXp-cxbHDkah6A.png" />  </p>
<p>Agora, vamos desenhar uma linha reta usando esses dados no grafico para visualizar a tendencia dos dados.  </p>
<p><img alt="" src="https://miro.medium.com/max/1151/1*rNMcykuFM15g_12WR3IzAQ.png" /></p>
<p>Esta linha reta representa a tendencia do preco das casas em relacao aos seus respectivos tamanhos. Agora, Poodemos encontrar,  <strong>aproximadamente</strong>, o preco de qualquer casa desta regiao colocando-a nesse grafico linear.<br />
E onde entram os neuronios? Bem, como acabamos de ver, o tamanho da casa e a  <strong>entrada</strong>  <strong>da</strong>  <strong>funcao</strong>  <strong>(x)</strong>  e o preco e a  <strong>saida (y)</strong>, e e ai que os  <strong>neuronios artificiais</strong>  aparecem.<br />
<img alt="" src="https://miro.medium.com/max/478/1*HRXdKWUeMitbi5bludDxGg.jpeg" /></p>
<p>Esse e o exemplo mais simples de uma rede neural, com uma unica entrada, processamento e saida. Esse processamento, caso haja alguma duvida, e feito por funcoes matematicas.<br />
Caso queiramos deixar as coisas mais interessantes, podemos adicionar outras variaveis de entrada, como  <strong>tamanho da familia</strong>,  <strong>cep</strong>,  <strong>numero de quartos</strong>,  <strong>qualidade das escolas da redondeza</strong>  e a <strong>classe economica da familia</strong>. O resultado da interligacao destas novas variaveis, seria algo mais ou menos assim: </p>
<p><img alt="" src="https://miro.medium.com/max/572/1*LOzkv1jwMh2JrKexkzJ7yg.png" /></p>
<h1><strong>Entropia cruzada? O que e isso?</strong></h1>
<p><strong>Entropia</strong>  e a medida do  <strong>grau de desordem</strong>  de um sistema, sendo uma medida da  <strong>indisponibilidade da energia</strong>.<br />
e uma grandeza fisica que esta relacionada com a  <strong>Mecanica Estatistica</strong>  e com a  <strong>Segunda Lei da Termodinamica</strong>, e que tende a aumentar naturalmente no Universo. A â€œ_desordem_â€ nao deve ser compreendida como â€œ_bagunca_â€ e sim como a forma de organizacao de sistema.<br />
<strong><em>Exemplo</em></strong>:<br />
<strong>Cubos de gelo derretendo,</strong>  antes de um cubo de gelo derreter, tem sua entropia menor, assim como seu  <strong>grau de desordem</strong>. Quando no estado solido, as distancias intermoleculares eram  <strong>bem</strong>-<strong>definidas</strong>, bem como os angulos entre essas moleculas. Durante a  <strong>fusao</strong>  do gelo, ocorre um grande aumento na <strong>multiplicidade de distancias e angulos</strong>  entre as moleculas, o que caracteriza o estado liquido.  </p>
<hr />
<p>Na computacao nao e diferente! A Entropia e uma medida da aleatoriedade de uma variavel, e define a medida de â€œ_falta de informacao_â€, mais precisamente o numero de  <strong>bits</strong>  necessarios, em media, para representar a informacao  <strong>em falta</strong>.<br />
Dado um conjunto  <strong>S</strong>, com instancias pertencentes Ã  classe  <strong>I</strong>, com probabilidade  <strong>P(i)</strong>  , temos:<br />
<img alt="" src="https://miro.medium.com/max/442/1*WHf71OjjWUL8fkGG7rBXBg.png" /><br />
<img alt="" src="https://miro.medium.com/max/585/1*WUu58Q-zBTAJO5gSdHx2uA.png" /><br />
<strong>S</strong>  e o conjunto de exemplo de treino,  <strong>p+</strong>  e a porcao de exemplos positivos, <strong>p-</strong>  e a porcao de exemplos negativos. Temos  <strong>Entropia(S) = 0</strong>  se existe um  <strong>i</strong>  tal que  <strong>P(i)</strong>  = 1 e assumido que  <strong>0 * log2 0 = 0.</strong><br />
Ela especifica o numero minimo de  <strong>bits</strong>  de  <strong>informacao</strong>  necessario para codificar uma classificacao de um  <strong>membro arbitrario</strong>  de  <strong>S</strong>.  </p>
<hr />
<p>Podemos classificar a  <strong>Entropia-Cruzada</strong>  como:<br />
<img alt="" src="https://miro.medium.com/max/301/1*ImtWFEVxsg78A5vK40D89A.png" /><br />
Onde  <strong>N</strong>  e o numero de amostras,  <strong>M</strong>  e o numero de camadas,  <strong>Sm</strong>  e a dimensao de cada camada e  <strong>Y</strong>  sao as saidas da rede.  </p>
<h1>Poesia Artificial</h1>
<p>Para nosso caso, utilizaremos uma base de dados(<strong>arquivo de texto</strong>) contendo diversas poesias. Caso voce queira, pode utilizar seus escritos, ou os escritos de seus escritores prediletos. Quanto maior a quantidade e diversidade, melhor!  </p>
<h1>Keras</h1>
<p>Ã€s palavras do proprio google, a Keras e uma biblioteca de rede neural de codigo aberto escrita em  <strong>Python</strong>(Linguagem de programacao). e capaz de rodar sobre  <strong>TensorFlow</strong>,  <strong>Microsoft Cognitive Toolkit</strong>,  <strong>R</strong>,  <strong>Theano</strong>  ou  <strong>PlaidML</strong>. Projetado para permitir experimentacao rapida com redes neurais profundas, ele se concentra em ser facil de usar, modular e extensivel, e ela sera utilizada para criacao do algoritmo.  </p>
<div class="codehilite"><pre><span></span><code><span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.sequence</span> <span class="kn">import</span> <span class="n">pad_sequences</span>  
<span class="kn">from</span> <span class="nn">tensorflow.keras.layers</span> <span class="kn">import</span> <span class="n">Embedding</span><span class="p">,</span> <span class="n">LSTM</span><span class="p">,</span> <span class="n">Dense</span><span class="p">,</span> <span class="n">Dropout</span><span class="p">,</span> <span class="n">Bidirectional</span>  
<span class="kn">from</span> <span class="nn">tensorflow.keras.preprocessing.text</span> <span class="kn">import</span> <span class="n">Tokenizer</span>  
<span class="kn">from</span> <span class="nn">tensorflow.keras.models</span> <span class="kn">import</span> <span class="n">Sequential</span>  
<span class="kn">from</span> <span class="nn">tensorflow.keras.optimizers</span> <span class="kn">import</span> <span class="n">Adam</span>  
<span class="kn">from</span> <span class="nn">tensorflow.keras</span> <span class="kn">import</span> <span class="n">regularizers</span>  
<span class="kn">import</span> <span class="nn">tensorflow.keras.utils</span> <span class="k">as</span> <span class="nn">ku</span>
</code></pre></div>


<h1>Tokenizing</h1>
<p>Entao, o  <strong>tokenizer</strong>  basicamente permite a gente vetorizar todas as palavras dos poemas em nosso enorme  <strong>corpus</strong>  (arquivo de texto) em uma sequencia de numeros inteiros ou vetores, o que pode ser util para inserir na rede neural.  </p>
<div class="codehilite"><pre><span></span><code>tokenizer = Tokenizer()  
data = open(â€˜poesias.txtâ€™,encoding=â€utf8&quot;).read()  
corpus = data.lower().split(â€œ\nâ€)  
tokenizer.fit_on_texts(corpus)  
total_words = len(tokenizer.word_index) + 1**
</code></pre></div>


<p>Para um entendimento aprofundado do procedimento de tokenizing, eu recomendo este  <a href="https://www.youtube.com/watch?v=AcLKZg-GvxA">video</a>.<br />
Apos vetorizadas, essas serao as entradas dos nossos  <strong>Neuronios Artificiais,</strong> No qual esperamos, na saida final, <strong>Uma Poesia.</strong>  </p>
<h1>Modelo de Construcao</h1>
<p>O metodo sequencial no  <strong>Keras</strong>  e o mais simples para criar um empilhamento de arquitetura de camadas, e e ele que nos vamos usar. O modelo sequencial nos permite inserir camadas de uma  <strong>Rede Neural Artificial</strong>  em serie, onde a  <strong>saida</strong>  da primeira camada serve como  <strong>entrada</strong>  da segunda, e assim por diante, como visto acima no exemplo das casas com multiplas variaveis.<br />
Tambem usaremos  <strong>entropia cruzada categorica</strong>  como funcao de perda e  <strong>Adam</strong>  (<a href="http://sebastianruder.com/optimizing-gradient-descent/index.html#adam">Adaptive Moment Estimation</a>  )como otimizador.<br />
  ```
model = Sequential()<br />
model.add(Embedding(total_words, 100, input_length=max_sequence_len-1))<br />
model.add(Bidirectional(LSTM(150, return_sequences = True)))<br />
model.add(Dropout(0.2))<br />
model.add(LSTM(100))<br />
model.add(Dense(total_words/2, activation=â€™reluâ€™, kernel_regularizer=regularizers.l2(0.01)))<br />
model.add(Dense(total_words, activation=â€™softmaxâ€™))<br />
model.compile(loss=â€™categorical_crossentropyâ€™, optimizer=â€™adamâ€™, metrics=[â€˜accuracyâ€™])<br />
print(model.summary())</p>
<div class="codehilite"><pre><span></span><code><span class="n">Depois</span><span class="w"> </span><span class="n">disso</span><span class="p">,</span><span class="w"> </span><span class="n">adicionamos</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">**</span><span class="n">camada</span><span class="w"> </span><span class="n">bidirecional</span><span class="o">**</span><span class="w"> </span><span class="o">[</span><span class="n">LSTM</span><span class="o">]</span><span class="p">(</span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">colah</span><span class="p">.</span><span class="n">github</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">posts</span><span class="o">/</span><span class="mi">2015</span><span class="o">-</span><span class="mi">08</span><span class="o">-</span><span class="n">Understanding</span><span class="o">-</span><span class="n">LSTMs</span><span class="o">/</span><span class="p">)(</span><span class="n">_Long</span><span class="w"> </span><span class="n">short</span><span class="o">-</span><span class="n">term</span><span class="w"> </span><span class="n">memory</span><span class="p">)</span><span class="n">_</span><span class="w"> </span><span class="n">que</span><span class="w"> </span><span class="n">deixa</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">arquitetura</span><span class="w"> </span><span class="n">mais</span><span class="w"> </span><span class="n">ou</span><span class="w"> </span><span class="n">menos</span><span class="w"> </span><span class="nl">assim</span><span class="p">:</span><span class="w">  </span>
<span class="err">![]</span><span class="p">(</span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">miro</span><span class="p">.</span><span class="n">medium</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="nf">max</span><span class="o">/</span><span class="mi">395</span><span class="o">/</span><span class="mi">1</span><span class="o">*</span><span class="n">hDwEVtQqqiPtzyJrACbGTQ</span><span class="p">.</span><span class="n">jpeg</span><span class="p">)</span><span class="w">  </span>
<span class="n">E</span><span class="w"> </span><span class="n">entao</span><span class="p">,</span><span class="w"> </span><span class="n">configuramos</span><span class="w"> </span><span class="n">uma</span><span class="w"> </span><span class="n">parte</span><span class="w"> </span><span class="n">mais</span><span class="w"> </span><span class="n">â</span><span class="err">€</span><span class="n">œvisualâ</span><span class="err">€:</span><span class="w">  </span>
</code></pre></div>


<p>plt.plot(epochs, acc, â€˜bâ€™, label=â€™Training accuracyâ€™)<br />
plt.title(â€˜Training accuracyâ€™)<br />
plt.figure()<br />
plt.plot(epochs, loss, â€˜bâ€™, label=â€™Training Lossâ€™)<br />
plt.title(â€˜Training lossâ€™)<br />
plt.legend()<br />
plt.show()</p>
<div class="codehilite"><pre><span></span><code>Essa parte nos ajuda Ã  visualizar, graficamente, o desempenho da nossa  **Rede Neural Artificial**, para saber se esta flui com bom desempenho no aprendizado.  
# Hora de Redigir!  
</code></pre></div>


<p>seed_text = â€œA vida e umaâ€<br />
next_words = 50  </p>
<p>for _ in range(next_words):<br />
 token_list = tokenizer.texts_to_sequences([seed_text])[0]<br />
 token_list = pad_sequences([token_list], maxlen=max_sequence_len-1, padding=â€™preâ€™)<br />
 predicted = model.predict_classes(token_list, verbose=0)<br />
 output_word = â€œâ€<br />
 for word, index in tokenizer.word_index.items():<br />
 if index == predicted:<br />
 output_word = word<br />
 break<br />
 seed_text += â€œ â€œ + output_word<br />
print(seed_text)
```  </p>
<p>â€œ<strong>seed_text</strong>â€ e um â€œ_gatilho_â€ para nossa Rede Neural. e com base nela que tudo vai comecar Ã  ser escrito. E â€œ<strong>next_words</strong>â€ serve para especificar quantas palavras deseja que ele escreva. E, apos tudo isso, basta rodar o codigo e ver nosso  <strong>Poeta Mecanico</strong>  agir. E entao, cabe a voce julgar a saida e interpretar, sentimentalmente ou nao, a expressao de uma maquina.</p>
<p>Alem da saida feita com escritores nacionais, esse e um exemplo de saida de testes com poemas feitos por escritores internacionais:</p>
<blockquote>
<p>What is this life converge in a late to depart blue years day a moon in little years putting putting i was blue without my victories day a ragtag bell without day a moon to our cache years the letters snaps blue day a moon day day they were never best friends into the</p>
</blockquote>
<p>Lembrando que</p>
<p><strong>o objetivo nao e a perfeicao</strong>, e pode nao ter tanto sentido nas primeiras tentativas. Mas, nada que tempo e ajustes manuais de gramatica e pontuacao nao resolvam. Claro, tambem e possivel corrigir os proprios erros utilizando Redes Neurais Artificiais, mas essa eu vou deixar para um proximo dia.</p>
<p>O codigo completo pode ser encontrado <a href="https://github.com/agrawalparth08/poetry-generation-lstm/blob/master/Poetry_Generation.ipynb">aqui</a>, e uma explicacao aprofundada no primeiro link nas referencias.<br />
Para fins de estudo e diversao, recomendo a publicacao de  <a href="https://medium.com/caio-noobs-around/p3ss04-utilizando-cadeias-de-markov-e-algoritmo-gen%C3%A9tico-para-a-gera%C3%A7%C3%A3o-de-poemas-generativos-caeed388dd0a">caioluders</a>  onde ele utiliza um metodo alternativo e super interessante para escrever poesias. Saca la!</p>
<h2>Referencias:</h2>
<p>TOWARDSDC â€”  <a href="https://towardsdatascience.com/creating-poems-from-ones-own-poems-neural-networks-and-life-paradoxes-a9cffd2b07e3">CREATING POEMS FROM ONE OWN POEMS</a><br />
TOWARDSDC â€” <a href="https://towardsdatascience.com/creating-poems-from-ones-own-poems-neural-networks-and-life-paradoxes-a9cffd2b07e3">WHATâ€™S A NEURAL NETWORK?</a><br />
REDES NEURAIS ARTIFICIAIS â€” CAPITULO2.PDF  </p></body><hr>by cnx</html>